<html><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>CIlib</title><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="Verifiable Computational Intelligence" /><meta name="author" content="net.cilib" /><meta name="og:image" content="/cilib/img/poster.png" /><meta name="og:title" content="CIlib" /><meta name="og:site_name" content="CIlib" /><meta name="og:url" content="http://cirg-up.github.io" /><meta name="og:type" content="website" /><meta name="og:description" content="Verifiable Computational Intelligence" /><meta name="twitter:image" content="/cilib/img/poster.png" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="" /><link rel="icon" type="image/png" href="/cilib/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/cilib/highlight/styles/default.css" /><link rel="stylesheet" href="/cilib/css/style.css" /><link rel="stylesheet" href="/cilib/css/palette.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/cilib/" class="brand"><div class="brand-wrapper" style="background:url('/cilib/img/sidebar_brand.png') no-repeat"><span>CIlib</span></div></a></li> <li><a href="/cilib/docs/index.html" class="">Getting Started</a></li> <li><a href="/cilib/docs/design/index.html" class="">Design</a> <ul class="sub_section"> <li><a href="/cilib/docs/design/rvar.html" class=" active ">RVar</a></li> <li><a href="/cilib/docs/design/position.html" class="">Position</a></li> <li><a href="/cilib/docs/design/lenses.html" class="">Lenses</a></li> <li><a href="/cilib/docs/design/entity.html" class="">Entity</a></li> <li><a href="/cilib/docs/design/step.html" class="">Step & Iteration</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="hidden-xs"><a href="https://github.com/cirg-up/cilib"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li class="hidden-xs"><a href="https://github.com/cirg-up/cilib"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('CIlib Verifiable Computational Intelligence');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('CIlib Verifiable Computational Intelligence');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="cirg-up" data-github-repo="cilib"><div class="content-wrapper"><section><h1 id="rvar">RVar</h1>

<p>An instance of <code class="highlighter-rouge">RVar</code> represents a computation that, when executed,
results in a value with randomness applied. <code class="highlighter-rouge">RVar</code> is one of the most
important structures in CIlib and is therefore discussed first in order to
understand how the data structure works.</p>

<p><code class="highlighter-rouge">RVar</code> has a <a href="">monad</a> instance and therefore allows a for a large amount
of composition, but more importantly allows for the tracking of randomness
within the <code class="highlighter-rouge">RVar</code> computation. This tracking is of the utmost importance
within computational intelligence algorithms, as randomness needs to be
controlled in a manner that facilitates repetition. In other words,
even if a computation uses randomness, given the same inputs, the same
results are expected even with randomness applied.</p>

<p>Due to the monadic nature of the data structure, the data structure may be
transformed by functions such as <code class="highlighter-rouge">map</code>, <code class="highlighter-rouge">flatMap</code>, etc</p>

<p>There are several predefined combinators that allow the user to use and
create <code class="highlighter-rouge">RVar</code> computations. These include functions for randomness applied
to primitive types (such and <code class="highlighter-rouge">Int</code> and <code class="highlighter-rouge">Double</code>) to more complex types that
build on the primitives, or even for user defined types.</p>

<p>The simplest would be to look at some examples of <code class="highlighter-rouge">RVar</code> usage. It is quite
common to request several random numbers. <code class="highlighter-rouge">RVar</code> provides several functions,
with <code class="highlighter-rouge">ints</code> and <code class="highlighter-rouge">doubles</code> being the most common for random variable
creation:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code>     <span class="o">|</span> <span class="k">val</span> <span class="n">ints</span> <span class="k">=</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">ints</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
<span class="n">ints</span><span class="k">:</span> <span class="kt">cilib.RVar</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">RVar$$anon$2</span><span class="k">@</span><span class="mi">52</span><span class="n">be95be</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">doubles</span> <span class="k">=</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">doubles</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
<span class="n">doubles</span><span class="k">:</span> <span class="kt">cilib.RVar</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">RVar$$anon$2</span><span class="k">@</span><span class="mi">1</span><span class="n">bfbd729</span>
</code></pre>
</div>

<p>Both functions result in a <code class="highlighter-rouge">RVar</code> that, when provided with a pseudo-random
number generator (PRNG), will result in a list of values.</p>

<p>The user if free to define a PRNG for themselves, but CIlib provides a default
PRNG that is suitable for scientific work. The CMWC generator may be
initialized by either providing a seed value for the pseudo-random number
stream, or it may be taken from the current time of the computer. It is always
recommended to record the seed value, so that others may reproduce results,
especially if the results are to be published.</p>

<p>Let’s create a <code class="highlighter-rouge">RNG</code> instance using both methods:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rng</span> <span class="k">=</span> <span class="nc">RNG</span><span class="o">.</span><span class="n">init</span><span class="o">(</span><span class="mi">1234L</span><span class="o">)</span>
<span class="n">rng</span><span class="k">:</span> <span class="kt">cilib.RNG</span> <span class="o">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">3163</span><span class="n">ab9e</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">fromTimeYOLO</span> <span class="k">=</span> <span class="nc">RNG</span><span class="o">.</span><span class="n">fromTime</span>
<span class="n">fromTimeYOLO</span><span class="k">:</span> <span class="kt">cilib.RNG</span> <span class="o">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">493</span><span class="n">e7f31</span>
</code></pre>
</div>

<p>Now, let’s run both <code class="highlighter-rouge">doubles</code> and <code class="highlighter-rouge">ints</code> with the generator:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">r1</span> <span class="k">=</span> <span class="n">ints</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">r1</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">418</span><span class="n">b38b1</span><span class="o">,</span><span class="nc">List</span><span class="o">(-</span><span class="mi">2012280037</span><span class="o">,</span> <span class="o">-</span><span class="mi">456312394</span><span class="o">,</span> <span class="o">-</span><span class="mi">1608573853</span><span class="o">,</span> <span class="o">-</span><span class="mi">1720473833</span><span class="o">,</span> <span class="mi">1662253751</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">doubles</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mf">6f</span><span class="n">c73188</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mf">0.5314795508050395</span><span class="o">,</span> <span class="mf">0.6254747152242208</span><span class="o">,</span> <span class="mf">0.3870236094802634</span><span class="o">,</span> <span class="mf">0.3590652564475848</span><span class="o">,</span> <span class="mf">0.1350043437170152</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">r2</span> <span class="k">=</span> <span class="n">ints</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">r2</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mf">7752f</span><span class="mi">11</span><span class="n">a</span><span class="o">,</span><span class="nc">List</span><span class="o">(-</span><span class="mi">2012280037</span><span class="o">,</span> <span class="o">-</span><span class="mi">456312394</span><span class="o">,</span> <span class="o">-</span><span class="mi">1608573853</span><span class="o">,</span> <span class="o">-</span><span class="mi">1720473833</span><span class="o">,</span> <span class="mi">1662253751</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">_2</span> <span class="o">==</span> <span class="n">r2</span><span class="o">.</span><span class="n">_2</span>
<span class="n">res2</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre>
</div>

<p>The result is a tuple of the state of the PRNG after being used in the
computation, together with the result of the computation itself. The
important point to note is that running the computation again, with the
same PRNG, that is the original state of the PRNG <em>will</em> result in the same
obtained results. Unlike the normal PRNG within the JVM platform, obtaining
some random value from the source does not implicitly mutate the PRNG. In
order to keep selecting from the PRNG stream, the next state of the PRNG
should be passed into subsequent computations, when needed:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">rng2</span><span class="o">,</span> <span class="n">x</span><span class="o">)</span> <span class="k">=</span> <span class="n">ints</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">rng2</span><span class="k">:</span> <span class="kt">cilib.RNG</span> <span class="o">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">79</span><span class="n">c62ec7</span>
<span class="n">x</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">2012280037</span><span class="o">,</span> <span class="o">-</span><span class="mi">456312394</span><span class="o">,</span> <span class="o">-</span><span class="mi">1608573853</span><span class="o">,</span> <span class="o">-</span><span class="mi">1720473833</span><span class="o">,</span> <span class="mi">1662253751</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">rng3</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=</span> <span class="n">ints</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng2</span><span class="o">)</span>
<span class="n">rng3</span><span class="k">:</span> <span class="kt">cilib.RNG</span> <span class="o">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">108</span><span class="n">e5dfa</span>
<span class="n">y</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">973239118</span><span class="o">,</span> <span class="mi">1542173555</span><span class="o">,</span> <span class="mi">1984558752</span><span class="o">,</span> <span class="mi">579839250</span><span class="o">,</span> <span class="mi">609517835</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre>
</div>

<p>This manual state passing for the PRNG is very cumbersome and as a result,
the monad instance of <code class="highlighter-rouge">RVar</code> provides this exact functionality to the user,
thereby preventing accidental errors due to incorrect usage of PRNG state.
Furthermore, the monad instance for <code class="highlighter-rouge">RVar</code> allows for cleaner syntax through
the use of a <code class="highlighter-rouge">for</code>-comprehension as provided by Scala:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">composition</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>   <span class="n">a</span> <span class="k">&lt;-</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">next</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="c1">// Get a single Int
</span>     <span class="o">|</span>   <span class="n">b</span> <span class="k">&lt;-</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">next</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="c1">// Get a single Double, using the next state of the PRNG
</span>     <span class="o">|</span>   <span class="n">c</span> <span class="k">&lt;-</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">next</span><span class="o">[</span><span class="kt">Boolean</span><span class="o">]</span> <span class="c1">// Get a Boolean, again passing the PRNG state
</span>     <span class="o">|</span> <span class="o">}</span> <span class="k">yield</span> <span class="k">if</span> <span class="o">(</span><span class="n">c</span><span class="o">)</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="k">else</span> <span class="n">b</span>
<span class="n">composition</span><span class="k">:</span> <span class="kt">cilib.RVar</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span> <span class="n">cilib</span><span class="o">.</span><span class="nc">RVar$$anon$2</span><span class="k">@</span><span class="mi">164840</span><span class="n">cf</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">composition</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">res4</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">4</span><span class="n">ca6d180</span><span class="o">,-</span><span class="mf">1.798488339436242E9</span><span class="o">)</span>
</code></pre>
</div>

<p>From this definition of how randomness is managed, we can derive several
useful algorithms which operate within the <code class="highlighter-rouge">RVar</code> computation. Please refer
to the <a href="http://cirg-up.github.io/cilib/api/cilib/RVar$.html">scaladoc</a> for
more combinators, but some of the more commonly used are illustrated below:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sampleList</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span>
<span class="n">sampleList</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">shuffle</span><span class="o">(</span><span class="n">sampleList</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">res5</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mf">1d5d</span><span class="n">f93d</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">6</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">RVar</span><span class="o">.</span><span class="n">sample</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">sampleList</span><span class="o">).</span><span class="n">run</span><span class="o">.</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">res6</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">scalaz.Maybe</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]])</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mf">5f</span><span class="n">f529dc</span><span class="o">,</span><span class="nc">Just</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">)))</span>
</code></pre>
</div>

<p>Building on <code class="highlighter-rouge">RVar</code>, we can easily define probability distributions from
which, randomness may be sampled. The provided distributions, where
standard distributions are also defined, include:</p>

<ul>
  <li>Uniform</li>
  <li>Gaussian / Normal</li>
  <li>Cauchy</li>
  <li>Gamma</li>
  <li>Exponential</li>
  <li>etc</li>
</ul>

<p>The interface for the distributions is simply a resulting <code class="highlighter-rouge">RVar</code></p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="c1">// Use a derived function from monad to repeat an action 'n' times
</span>     <span class="o">|</span> <span class="nc">Dist</span><span class="o">.</span><span class="n">stdNormal</span><span class="o">.</span><span class="n">replicateM</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="n">run</span><span class="o">(</span><span class="n">rng</span><span class="o">)</span>
<span class="n">res8</span><span class="k">:</span> <span class="o">(</span><span class="kt">cilib.RNG</span><span class="o">,</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=</span> <span class="o">(</span><span class="n">cilib</span><span class="o">.</span><span class="nc">CMWC</span><span class="k">@</span><span class="mi">1234</span><span class="n">ec50</span><span class="o">,</span><span class="nc">List</span><span class="o">(</span><span class="mf">0.12471034611540575</span><span class="o">,</span> <span class="mf">0.10241216207344515</span><span class="o">,</span> <span class="o">-</span><span class="mf">0.49485286860096944</span><span class="o">,</span> <span class="o">-</span><span class="mf">2.6592051237450325</span><span class="o">,</span> <span class="mf">0.7016898748604742</span><span class="o">))</span>
</code></pre>
</div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/cilib/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/cilib/js/main.js"></script></body></html>